## This diagram shows the key components of the application:
1. Frontend (NGINX): Two web servers handle the frontend requests.
2. Backend (Node.js API): Two API servers to process requests.
3. PostgreSQL Database: A central database server for storing patient data.
4. Redis: Caching layer for better performance.
5. HAProxy: Load balancer to distribute traffic across NGINX web servers and Node.js API servers.
6. Backup System: A local Linux-based backup system to back up the system’s data.

<img width="512" alt="image" src="https://github.com/user-attachments/assets/ddd9056d-1314-4719-a7f8-f71dd1ad8f31" />

## <ins>1. Discovery and Tooling Setup</ins>
### Tools for Discovery
- **Azure Migrate Appliance:** The Azure Migrate appliance will be deployed on the on-premises servers to collect data about the infrastructure, including server performance, configurations, and dependencies. It will help gather the information needed for a detailed assessment.
- **Agentless Discovery:** For environments where deploying an agent may be difficult, the agentless approach will be used to scan the servers and gather essential data.
- **Azure Migrate:** Server Assessment: This tool will provide insights into the on-premises workloads and suggest the optimal sizing, cost estimation, and performance metrics for Azure-based resources.

### Types of Data to Collect
- **Operating System Information:** Version of Ubuntu Linux running on the servers (to ensure compatibility with Azure services).
- **Software Inventory:** Information about installed software packages, including NGINX, Node.js, PostgreSQL, Redis, and HAProxy.
- **Dependencies:** Identify interdependencies between the web servers (frontend), API servers (backend), database (PostgreSQL), and cache (Redis).
- **Server Performance Metrics:** CPU, memory, storage, and network utilization for each of the components to determine the sizing requirements for Azure.
- **Backup and Restore Data:** Current backup schedules and configurations to ensure compliance with Tailwind OpenCare’s backup and recovery requirements.

### Credentials and Permissions Management
- **Azure Active Directory (AAD):** All migration tools and processes will authenticate through Azure Active Directory to ensure secure access management.
- **Role-Based Access Control (RBAC):** Azure RBAC will be configured to ensure that only authorized users and groups have the necessary permissions to perform discovery, assessment, and migration tasks.
- **Credential Storage:** Credentials, such as API keys and database connection details, will be securely stored in Azure Key Vault, ensuring that sensitive information is protected during the migration process.

 -----------------------------------------------------
 ## <ins>2. Assessment Planning</ins>
 An assessment with the Discovery and Assessment tool measures the readiness and estimates the effect of migrating on-premises servers to Azure.
### Assessment Parameters
- **Performance History:** Analyze the historical CPU, memory, and storage performance of the on-premises servers over the past 30 days to determine appropriate sizing in Azure.
- **Sizing Strategy:** Azure Migrate will recommend VM sizes based on the performance data, ensuring the target Azure resources are adequately sized to handle the expected workload with minimal over-provisioning.
- **Cost Estimation:** Based on the performance and resource utilization data, Azure Migrate will provide an estimated cost for the Azure resources needed to run the application.

### Target Azure Region, Compute Type, and Storage Type
- **Azure Region:** The most suitable Azure region will be selected based on Tailwind OpenCare’s geographical requirements and compliance needs. The East US 2 region is a strong candidate due to its proximity and availability of required services.

- **Compute Type:**
**Frontend (NGINX) and Backend (Node.js):** Azure Virtual Machines (VMs) will be used to replicate the current infrastructure. The recommended size for these VMs would be Standard D2 v3 instances, offering a balance of CPU, memory, and network performance.
**PostgreSQL Database:** Azure Database for PostgreSQL (Single Server) will be used for high availability and automatic scaling.
**Redis:** Azure Cache for Redis will be used to provide scalable and managed caching.

- **Storage Type:**
**Standard SSD** will be used for the VMs to provide a good balance of cost and performance.
**Premium SSD** will be considered for the PostgreSQL database, ensuring high I/O throughput.

### Validating Assessment Results with Stakeholders
- **Presentation of Sizing and Cost Estimates:** Share detailed reports generated by Azure Migrate, including performance history, VM sizing recommendations, and cost estimates.
- **Stakeholder Review:** Meet with relevant stakeholders, including infrastructure and application owners, to ensure that the proposed infrastructure and costs align with business needs and compliance requirements.
- **Feedback Loop:** Adjust the configurations based on feedback and ensure that all concerns regarding performance, scalability, and security are addressed before proceeding.

---------------------------------------------

## <ins>3. Dependency Analysis and Optimization</ins>
### Dependency Mapping
- **Agentless Dependency Mapping** will be used, which will collect metadata from the infrastructure without requiring additional agents. 

- **Azure Migrate:** Dependency Visualization: The tool will provide visual diagrams showing how different services (e.g., NGINX, Node.js API, PostgreSQL, Redis) interact with each other. This is essential to understand which components need to be migrated together.

### Cleaning Dependency Data
- **Known System Dependencies:** We will manually filter out common system dependencies (e.g., network configurations, basic OS packages) that don’t affect the migration.

- **Redundant Services:** Any unnecessary services or software dependencies not required in the cloud environment will be removed or refactored.

### Key Metrics for Each Component
- **Criticality:** Identify high-priority systems like the PostgreSQL database and API servers.
- **User Base:** Understand the expected number of concurrent users to estimate resource requirements.
- **SLA (Service Level Agreements):** Define the expected uptime and response time for each service. For example, the database may require a higher SLA (e.g., 99.99% availability).
- **Backup Requirements:** Ensure daily backups are scheduled for the database and any critical data, using Azure’s built-in backup features.

------------------------------------------------------
## <ins>4. Server Grouping and Migration Waves</ins>
### Logical Server Groupings
- **Frontend Group:** NGINX web servers that handle incoming HTTP/S traffic.
- **Backend Group:** Node.js API servers responsible for business logic and application functionality.
- **Database Group:** PostgreSQL database server for data storage.
- **Cache Group:** Redis instances for caching data and improving application performance.

### Prioritization and Grouping
- **Wave 1:** Migrate the Frontend and Backend groups together, as they are interdependent for handling user requests.
- **Wave 2:** Migrate the Database and Cache groups. This is critical to minimize downtime as the application cannot function without the database and cache layer.
- **Wave 3:** Finalize migration of Backup Systems and any other ancillary services.

### Firewall Rules, Load Balancer Configurations, and IP Changes
- **Azure Load Balancer** will be configured to distribute traffic between the frontend and backend servers, replacing the HAProxy configuration.

- **DNS Changes:** The DNS entries will be updated to point to the Azure Load Balancer after migration.
----------------------------------------------------------------

## <ins>5. Migration Plan Documentation</ins>
### Step-by-Step Migration Plan

- **1. Pre-Migration Testing:**
Conduct a dry run migration using Azure Migrate’s testing functionality to simulate the migration process.

Validate application performance and functionality in the Azure environment using test workloads.

- **2. Backup:**
Ensure that daily backups are configured for PostgreSQL and Redis in Azure.

Use Azure Backup for backup validation.

- **3. VM Deployment:**
Create Azure VMs for the frontend and backend servers.

Configure Azure Database for PostgreSQL and Azure Cache for Redis.

- **4. DNS and Load Balancer Setup:**
Update DNS records to point to the Azure Load Balancer.

Configure Azure Load Balancer to distribute traffic to the new VMs.

- **5. Post-Migration Validation:**
Perform application validation to ensure everything works as expected.

Application owners will verify that all critical functionality is operational.

- **6. Rollback Plan:**
Document a rollback plan to revert to the on-premises environment if critical issues arise during migration.



